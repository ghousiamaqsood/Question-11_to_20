"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.parseBooleanArg = void 0;
const list_1 = require("@typed/list");
const logic_1 = require("@typed/logic");
const maybe_1 = require("@typed/maybe");
const createParser_1 = require("./createParser");
const getPositionalArgumentValue_1 = require("./getPositionalArgumentValue");
const isArgumentFlag_1 = require("./isArgumentFlag");
const isTrue = logic_1.equals('true');
function parseBooleanArg(name, options = {}) {
    return createParser_1.createParser(name, options, (index, args) => {
        const [valueIndex, value] = parseBooleanArgByPosition(index, args);
        const indexesUsed = list_1.uniq([index, valueIndex]);
        const result = [
            indexesUsed,
            maybe_1.Just.of({ [name]: value }),
        ];
        return result;
    });
}
exports.parseBooleanArg = parseBooleanArg;
function parseBooleanArgByPosition(index, args) {
    const positionalArg = getPositionalArgumentValue_1.getPositionalArgumentValue(index, args);
    if (maybe_1.isNothing(positionalArg)) {
        return [index, true];
    }
    const [valueIndex, arg] = maybe_1.fromJust(positionalArg);
    if (isArgumentFlag_1.isArgumentFlag(arg)) {
        return [index, true];
    }
    return [valueIndex, isTrue(arg)];
}
//# sourceMappingURL=parseBooleanArg.js.map