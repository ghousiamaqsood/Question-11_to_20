"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.futurify = void 0;
const disposable_1 = require("@typed/disposable");
const future_1 = require("@typed/future");
function futurify(fn) {
    return (...args) => {
        return future_1.Future.create((reject, resolve) => {
            const disposable = disposable_1.Disposable.lazy();
            disposable.addDisposable(disposable_1.withIsDisposed((isDisposed) => {
                args.push((err, value) => {
                    if (isDisposed()) {
                        return;
                    }
                    if (err) {
                        return disposable.addDisposable(reject(err));
                    }
                    return disposable.addDisposable(resolve(value));
                });
                fn.apply(void 0, args);
            }));
            return disposable;
        });
    };
}
exports.futurify = futurify;
//# sourceMappingURL=futurify.js.map